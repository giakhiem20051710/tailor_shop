<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H√†nh Tr√¨nh X√¢y D·ª±ng Tailor Shop - Project Story</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e8e8e8;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.9;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #e94560;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: normal;
            letter-spacing: 2px;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 40px;
            font-style: italic;
        }

        .chapter {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 35px 40px;
            margin: 40px 0;
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
        }

        .chapter::before {
            content: '';
            position: absolute;
            left: -20px;
            top: 50px;
            width: 4px;
            height: calc(100% - 100px);
            background: linear-gradient(to bottom, #e94560, #0f3460);
            border-radius: 2px;
        }

        .chapter-number {
            position: absolute;
            left: -45px;
            top: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #e94560, #ff6b8a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            color: white;
            box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);
        }

        h2 {
            color: #e94560;
            font-size: 1.6em;
            margin-bottom: 20px;
            font-weight: normal;
            border-bottom: 1px solid rgba(233, 69, 96, 0.3);
            padding-bottom: 10px;
        }

        h3 {
            color: #00d9ff;
            font-size: 1.2em;
            margin: 30px 0 15px;
            font-weight: normal;
        }

        p {
            margin-bottom: 18px;
            text-align: justify;
        }

        .story-text {
            font-size: 1.05em;
            color: #d0d0d0;
        }

        .highlight {
            color: #00ff88;
            font-weight: bold;
        }

        .problem-box {
            background: linear-gradient(135deg, rgba(233, 69, 96, 0.15), rgba(233, 69, 96, 0.05));
            padding: 20px 25px;
            border-radius: 12px;
            border-left: 4px solid #e94560;
            margin: 25px 0;
        }

        .problem-box h4 {
            color: #e94560;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .solution-box {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(0, 217, 255, 0.05));
            padding: 20px 25px;
            border-radius: 12px;
            border-left: 4px solid #00ff88;
            margin: 25px 0;
        }

        .solution-box h4 {
            color: #00ff88;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .lesson-box {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.05));
            padding: 20px 25px;
            border-radius: 12px;
            border-left: 4px solid #ffd700;
            margin: 25px 0;
        }

        .lesson-box h4 {
            color: #ffd700;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        code {
            background: rgba(0, 0, 0, 0.4);
            padding: 3px 10px;
            border-radius: 5px;
            color: #00ff88;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        pre {
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9em;
        }

        pre code {
            padding: 0;
            background: transparent;
            color: #e0e0e0;
        }

        .keyword {
            color: #ff79c6;
        }

        .string {
            color: #f1fa8c;
        }

        .comment {
            color: #6272a4;
        }

        .function {
            color: #50fa7b;
        }

        .tech-tag {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            margin: 3px;
            font-family: 'Segoe UI', sans-serif;
        }

        .tag-fe {
            background: #61dafb;
            color: #000;
        }

        .tag-be {
            background: #6db33f;
            color: #fff;
        }

        .tag-db {
            background: #336791;
            color: #fff;
        }

        .tag-cache {
            background: #dc382d;
            color: #fff;
        }

        .mermaid {
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .quote {
            font-style: italic;
            color: #aaa;
            padding: 15px 25px;
            border-left: 3px solid #e94560;
            margin: 20px 0;
        }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline-item {
            position: relative;
            padding-bottom: 25px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 8px;
            width: 12px;
            height: 12px;
            background: #e94560;
            border-radius: 50%;
        }

        .timeline-item::after {
            content: '';
            position: absolute;
            left: -20px;
            top: 20px;
            width: 2px;
            height: calc(100% - 10px);
            background: rgba(233, 69, 96, 0.3);
        }

        .timeline-item:last-child::after {
            display: none;
        }

        .back-link {
            display: inline-block;
            color: #00d9ff;
            text-decoration: none;
            margin-bottom: 20px;
            padding: 10px 20px;
            border: 1px solid #00d9ff;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-family: 'Segoe UI', sans-serif;
        }

        .back-link:hover {
            background: rgba(0, 217, 255, 0.2);
        }

        .chapter-intro {
            font-size: 1.1em;
            color: #bbb;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
        }

        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #666;
            font-family: 'Segoe UI', sans-serif;
        }

        ul,
        ol {
            margin: 15px 0 15px 25px;
        }

        li {
            margin: 10px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê Quay l·∫°i trang ch√≠nh</a>

        <h1>üßµ H√†nh Tr√¨nh X√¢y D·ª±ng Tailor Shop</h1>
        <p class="subtitle">C√¢u chuy·ªán gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ t·ª´ Frontend ƒë·∫øn Backend</p>

        <!-- OPENING -->
        <div class="chapter" style="border-left: none; padding-left: 40px;">
            <p class="story-text">
                ƒê√¢y l√† c√¢u chuy·ªán v·ªÅ h√†nh tr√¨nh em x√¢y d·ª±ng <span class="highlight">Tailor Shop</span> -
                m·ªôt h·ªá th·ªëng qu·∫£n l√Ω c·ª≠a h√†ng may ƒëo tr·ª±c tuy·∫øn. Trong su·ªët qu√° tr√¨nh ph√°t tri·ªÉn,
                em ƒë√£ g·∫∑p nhi·ªÅu th√°ch th·ª©c th√∫ v·ªã v√† h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu ƒëi·ªÅu...
            </p>
        </div>

        <!-- CHAPTER 1: THE BEGINNING -->
        <div class="chapter">
            <div class="chapter-number">1</div>
            <h2>Kh·ªüi ƒê·∫ßu: Ph√¢n T√≠ch Y√™u C·∫ßu</h2>

            <p class="chapter-intro">
                M·ªçi th·ª© b·∫Øt ƒë·∫ßu t·ª´ vi·ªác hi·ªÉu r√µ business domain c·ªßa m·ªôt c·ª≠a h√†ng may ƒëo...
            </p>

            <p class="story-text">
                Khi b·∫Øt ƒë·∫ßu d·ª± √°n, em nh·∫≠n ra r·∫±ng m·ªôt c·ª≠a h√†ng may ƒëo r·∫•t kh√°c v·ªõi e-commerce th√¥ng th∆∞·ªùng.
                Kh√°ch h√†ng kh√¥ng ch·ªâ ƒë∆°n gi·∫£n l√† "th√™m v√†o gi·ªè h√†ng v√† thanh to√°n", m√† c√≤n c·∫ßn:
            </p>

            <ul class="story-text">
                <li>ƒê·∫∑t l·ªãch h·∫πn ƒë·ªÉ ƒëo s·ªë ƒëo</li>
                <li>L∆∞u l·ªãch s·ª≠ s·ªë ƒëo qua nhi·ªÅu l·∫ßn</li>
                <li>Theo d√µi ti·∫øn tr√¨nh may (ƒëang c·∫Øt, ƒëang may, ƒëang th·ª≠...)</li>
                <li>Ch·ªçn v·∫£i v·ªõi nhi·ªÅu th√¥ng s·ªë k·ªπ thu·∫≠t</li>
            </ul>

            <div class="problem-box">
                <h4>ü§î V·∫•n ƒë·ªÅ ƒë·∫ßu ti√™n: Ki·∫øn tr√∫c n√†o ph√π h·ª£p?</h4>
                <p class="story-text">
                    Em ƒë·ª©ng tr∆∞·ªõc l·ª±a ch·ªçn: <strong>Microservices</strong> hay <strong>Monolith</strong>?
                </p>
            </div>

            <p class="story-text">
                Sau khi c√¢n nh·∫Øc, em ch·ªçn <span class="highlight">Modular Monolith</span>. L√Ω do:
            </p>

            <div class="solution-box">
                <h4>üí° Quy·∫øt ƒë·ªãnh: Modular Monolith</h4>
                <ul class="story-text">
                    <li><strong>Team size nh·ªè:</strong> Ch·ªâ c√≥ 1-2 ng∆∞·ªùi, kh√¥ng c·∫ßn ph·ª©c t·∫°p h√≥a</li>
                    <li><strong>Debug d·ªÖ h∆°n:</strong> Kh√¥ng ph·∫£i trace qua nhi·ªÅu services</li>
                    <li><strong>Database ƒë∆°n gi·∫£n:</strong> JOIN, transaction l√†m vi·ªác b√¨nh th∆∞·ªùng</li>
                    <li><strong>Future-proof:</strong> C√≥ th·ªÉ t√°ch th√†nh Microservices sau n·∫øu c·∫ßn scale</li>
                </ul>
            </div>

            <p class="story-text">
                Em chia d·ª± √°n th√†nh 15 modules, m·ªói module c√≥ <code>controller</code>, <code>service</code>,
                <code>repository</code>, <code>dto</code>, <code>entity</code> ri√™ng:
            </p>

            <pre><code>tailor_shop/modules/
‚îú‚îÄ‚îÄ auth/           <span class="comment"># X√°c th·ª±c</span>
‚îú‚îÄ‚îÄ user/           <span class="comment"># Qu·∫£n l√Ω ng∆∞·ªùi d√πng</span>
‚îú‚îÄ‚îÄ product/        <span class="comment"># S·∫£n ph·∫©m</span>
‚îú‚îÄ‚îÄ fabric/         <span class="comment"># V·∫£i</span>
‚îú‚îÄ‚îÄ order/          <span class="comment"># ƒê∆°n h√†ng</span>
‚îú‚îÄ‚îÄ flashsale/      <span class="comment"># Flash sale</span>
‚îú‚îÄ‚îÄ appointment/    <span class="comment"># L·ªãch h·∫πn</span>
‚îú‚îÄ‚îÄ measurement/    <span class="comment"># S·ªë ƒëo</span>
‚îî‚îÄ‚îÄ ...</code></pre>

            <div class="lesson-box">
                <h4>üìù B√†i h·ªçc r√∫t ra</h4>
                <p class="story-text">
                    "Start simple, add complexity when you feel the pain." - ƒê·ª´ng over-engineering
                    ngay t·ª´ ƒë·∫ßu, h√£y ƒë·ªÉ v·∫•n ƒë·ªÅ th·ª±c t·∫ø d·∫´n ƒë∆∞·ªùng cho ki·∫øn tr√∫c.
                </p>
            </div>
        </div>

        <!-- CHAPTER 2: FLASH SALE -->
        <div class="chapter">
            <div class="chapter-number">2</div>
            <h2>Th·ª≠ Th√°ch L·ªõn: X√¢y D·ª±ng Flash Sale</h2>

            <p class="chapter-intro">
                Flash Sale l√† t√≠nh nƒÉng ph·ª©c t·∫°p nh·∫•t m√† em t·ª´ng implement...
            </p>

            <p class="story-text">
                Kh√°ch h√†ng mu·ªën c√≥ t√≠nh nƒÉng gi·ªëng Shopee: Sale trong th·ªùi gian gi·ªõi h·∫°n,
                s·ªë l∆∞·ª£ng c√≥ h·∫°n, ai nhanh tay th√¨ ƒë∆∞·ª£c mua. Nghe ƒë∆°n gi·∫£n, nh∆∞ng...
            </p>

            <div class="problem-box">
                <h4>üî• V·∫•n ƒë·ªÅ: 1000 ng∆∞·ªùi b·∫•m "Mua" c√πng l√∫c</h4>
                <p class="story-text">
                    N·∫øu ch·ªâ ƒë∆°n gi·∫£n <code>stock = stock - 1</code>, ƒëi·ªÅu g√¨ x·∫£y ra?
                </p>
                <pre><code><span class="comment">// 1000 users ƒë·ªçc stock = 10 c√πng l√∫c</span>
User 1: SELECT stock ‚Üí 10 ‚Üí UPDATE stock = 9 ‚úì
User 2: SELECT stock ‚Üí 10 ‚Üí UPDATE stock = 9 <span class="comment">// Ghi ƒë√®!</span>
User 3: SELECT stock ‚Üí 10 ‚Üí UPDATE stock = 9 <span class="comment">// Ghi ƒë√®!</span>
...
<span class="comment">// K·∫øt qu·∫£: stock = 9, nh∆∞ng ƒë√£ b√°n 1000 ƒë∆°n!</span>
<span class="comment">// ‚Üí OVERSELLING!</span></code></pre>
            </div>

            <h3>üîß Gi·∫£i ph√°p 1: Pessimistic Locking</h3>

            <p class="story-text">
                Em quy·∫øt ƒë·ªãnh d√πng <span class="highlight">Pessimistic Locking</span> v·ªõi
                <code>SELECT ... FOR UPDATE</code>. C√°ch n√†y lock row ngay t·ª´ ƒë·∫ßu,
                ƒë·∫£m b·∫£o ch·ªâ 1 transaction ƒë∆∞·ª£c x·ª≠ l√Ω t·∫°i m·ªôt th·ªùi ƒëi·ªÉm.
            </p>

            <pre><code><span class="keyword">@Transactional</span>(isolation = Isolation.SERIALIZABLE)
<span class="keyword">public</span> FlashSalePurchaseResult <span class="function">purchase</span>(Long flashSaleId, ...) {
    <span class="comment">// 1. LOCK row - c√°c transactions kh√°c ph·∫£i ƒë·ª£i</span>
    FlashSale sale = flashSaleRepository.<span class="function">findByIdForUpdate</span>(flashSaleId);
    
    <span class="comment">// 2. Check stock</span>
    <span class="keyword">if</span> (sale.getAvailableQuantity() < quantity) {
        <span class="keyword">return</span> Result.OUT_OF_STOCK;
    }
    
    <span class="comment">// 3. Reserve stock</span>
    sale.setReservedQuantity(sale.getReservedQuantity().add(quantity));
    
    <span class="comment">// 4. Create order</span>
    ...
}</code></pre>

            <div class="problem-box">
                <h4>ü§î V·∫•n ƒë·ªÅ m·ªõi: User click Mua r·ªìi... b·ªè ƒëi?</h4>
                <p class="story-text">
                    N·∫øu tr·ª´ stock ngay khi user click "Mua", nh∆∞ng h·ªç kh√¥ng thanh to√°n th√¨ sao?
                    Stock s·∫Ω b·ªã gi·ªØ vƒ©nh vi·ªÖn!
                </p>
            </div>

            <h3>üîß Gi·∫£i ph√°p 2: Reservation System</h3>

            <p class="story-text">
                Em implement h·ªá th·ªëng "gi·ªØ h√†ng" 10 ph√∫t - gi·ªëng nh∆∞ ƒë·∫∑t v√© m√°y bay:
            </p>

            <div class="solution-box">
                <h4>üí° Reservation Flow</h4>
                <div class="timeline">
                    <div class="timeline-item">
                        <strong>User click "Mua":</strong> T·∫°o Reservation, gi·ªØ h√†ng 10 ph√∫t
                    </div>
                    <div class="timeline-item">
                        <strong>User thanh to√°n:</strong> Reservation ‚Üí CONVERTED, soldQuantity += 1
                    </div>
                    <div class="timeline-item">
                        <strong>Qu√° 10 ph√∫t:</strong> Reservation ‚Üí EXPIRED, stock ƒë∆∞·ª£c tr·∫£ l·∫°i
                    </div>
                </div>
            </div>

            <p class="story-text">
                ƒê·ªÉ t·ª± ƒë·ªông release expired reservations, em t·∫°o <span class="highlight">Scheduled Task</span>
                ch·∫°y m·ªói 30 gi√¢y:
            </p>

            <pre><code><span class="keyword">@Scheduled</span>(fixedRate = 30000) <span class="comment">// Every 30 seconds</span>
<span class="keyword">public void</span> <span class="function">releaseExpiredReservations</span>() {
    List<Reservation> expired = reservationRepository
        .<span class="function">findByStatusAndExpiresAtBefore</span>(ACTIVE, LocalDateTime.now());
    
    <span class="keyword">for</span> (Reservation r : expired) {
        <span class="comment">// Tr·∫£ stock l·∫°i</span>
        flashSale.setReservedQuantity(
            flashSale.getReservedQuantity().<span class="function">subtract</span>(r.getQuantity())
        );
        r.setStatus(EXPIRED);
    }
}</code></pre>

            <h3>üñ•Ô∏è Frontend: Countdown Timer</h3>

            <p class="story-text">
                Ph√≠a Frontend <span class="tech-tag tag-fe">React</span>, em c·∫ßn hi·ªÉn th·ªã:
            </p>

            <ul class="story-text">
                <li>Countdown ƒë·∫øn khi flash sale b·∫Øt ƒë·∫ßu/k·∫øt th√∫c</li>
                <li>Stock c√≤n l·∫°i (c·∫≠p nh·∫≠t real-time)</li>
                <li>Timer 10 ph√∫t ƒë·ªÉ thanh to√°n sau khi ƒë·∫∑t h√†ng</li>
            </ul>

            <pre><code><span class="comment">// FlashSaleCard.jsx</span>
<span class="keyword">const</span> [timeLeft, setTimeLeft] = <span class="function">useState</span>(calculateTimeLeft());
<span class="keyword">const</span> [stock, setStock] = <span class="function">useState</span>(flashSale.availableQuantity);

<span class="function">useEffect</span>(() => {
    <span class="keyword">const</span> timer = <span class="function">setInterval</span>(() => {
        setTimeLeft(<span class="function">calculateTimeLeft</span>());
    }, 1000);
    
    <span class="comment">// Poll stock every 5 seconds</span>
    <span class="keyword">const</span> stockPoller = <span class="function">setInterval</span>(<span class="keyword">async</span> () => {
        <span class="keyword">const</span> data = <span class="keyword">await</span> api.<span class="function">getFlashSaleStock</span>(flashSale.id);
        <span class="function">setStock</span>(data.availableQuantity);
    }, 5000);
    
    <span class="keyword">return</span> () => {
        <span class="function">clearInterval</span>(timer);
        <span class="function">clearInterval</span>(stockPoller);
    };
}, []);</code></pre>

            <div class="lesson-box">
                <h4>üìù B√†i h·ªçc r√∫t ra</h4>
                <p class="story-text">
                    "Think about failure cases BEFORE implementing the happy path." - Lu√¥n t·ª± h·ªèi:
                    "ƒêi·ªÅu g√¨ x·∫£y ra n·∫øu user b·ªè gi·ªØa ch·ª´ng? N·∫øu m·∫•t m·∫°ng? N·∫øu refresh trang?"
                </p>
            </div>
        </div>

        <!-- CHAPTER 3: ORDER STATE MACHINE -->
        <div class="chapter">
            <div class="chapter-number">3</div>
            <h2>May ƒêo L√† Ngh·ªá Thu·∫≠t: Order State Machine</h2>

            <p class="chapter-intro">
                M·ªôt ƒë∆°n h√†ng may ƒëo kh√¥ng ch·ªâ ƒë∆°n gi·∫£n l√† "ƒêang x·ª≠ l√Ω ‚Üí Ho√†n th√†nh"...
            </p>

            <p class="story-text">
                Khi l√†m vi·ªác v·ªõi ch·ªß ti·ªám may, em nh·∫≠n ra quy tr√¨nh r·∫•t ph·ª©c t·∫°p:
            </p>

            <div class="mermaid">
                stateDiagram-v2
                [*] --> DRAFT : T·∫°o m·ªõi
                DRAFT --> WAITING_FOR_QUOTE : G·ª≠i y√™u c·∫ßu
                WAITING_FOR_QUOTE --> CONFIRMED : Kh√°ch ƒë·ªìng √Ω gi√°
                CONFIRMED --> IN_PROGRESS : B·∫Øt ƒë·∫ßu may
                IN_PROGRESS --> FITTING : Th·ª≠ ƒë·ªì
                FITTING --> IN_PROGRESS : C·∫ßn ch·ªânh s·ª≠a
                FITTING --> COMPLETED : Ho√†n th√†nh
                COMPLETED --> [*]
            </div>

            <div class="problem-box">
                <h4>ü§î V·∫•n ƒë·ªÅ: L√†m sao ƒë·∫£m b·∫£o kh√¥ng skip b∆∞·ªõc?</h4>
                <p class="story-text">
                    Kh√¥ng th·ªÉ cho ph√©p chuy·ªÉn t·ª´ DRAFT th·∫≥ng sang COMPLETED.
                    M·ªói b∆∞·ªõc ph·∫£i ƒë∆∞·ª£c validate.
                </p>
            </div>

            <h3>üîß Gi·∫£i ph√°p: State Transition Validation</h3>

            <pre><code><span class="keyword">public class</span> OrderStatus {
    <span class="keyword">private static final</span> Map<OrderStatus, List<OrderStatus>> ALLOWED_TRANSITIONS = Map.of(
        DRAFT, List.of(WAITING_FOR_QUOTE, CANCELLED),
        WAITING_FOR_QUOTE, List.of(CONFIRMED, CANCELLED),
        CONFIRMED, List.of(IN_PROGRESS, CANCELLED),
        IN_PROGRESS, List.of(FITTING, CANCELLED),
        FITTING, List.of(COMPLETED, IN_PROGRESS, CANCELLED) <span class="comment">// C√≥ th·ªÉ quay l·∫°i!</span>
    );
    
    <span class="keyword">public static boolean</span> <span class="function">isTransitionAllowed</span>(OrderStatus from, OrderStatus to) {
        <span class="keyword">return</span> ALLOWED_TRANSITIONS.getOrDefault(from, List.of()).contains(to);
    }
}</code></pre>

            <h3>üìú Timeline: L∆∞u l·∫°i m·ªçi thay ƒë·ªïi</h3>

            <p class="story-text">
                Em t·∫°o <code>OrderTimeline</code> entity ƒë·ªÉ l∆∞u l·ªãch s·ª≠. Khi kh√°ch h·ªèi
                "ƒê∆°n h√†ng c·ªßa t√¥i ƒëang ·ªü ƒë√¢u?", em c√≥ th·ªÉ show:
            </p>

            <div class="solution-box">
                <h4>üí° Order Tracking UI</h4>
                <div class="timeline">
                    <div class="timeline-item">
                        <strong>10/01 09:00</strong> - ƒê√£ t·∫°o ƒë∆°n h√†ng
                    </div>
                    <div class="timeline-item">
                        <strong>10/01 14:30</strong> - ƒê√£ x√°c nh·∫≠n b√°o gi√°: 2,500,000ƒë
                    </div>
                    <div class="timeline-item">
                        <strong>11/01 08:00</strong> - B·∫Øt ƒë·∫ßu may - Th·ª£: Anh Minh
                    </div>
                    <div class="timeline-item">
                        <strong>15/01 16:00</strong> - ƒêang trong qu√° tr√¨nh th·ª≠ ƒë·ªì
                    </div>
                </div>
            </div>

            <h3>üñ•Ô∏è Frontend: Multi-step Order Form</h3>

            <p class="story-text">
                Ph√≠a <span class="tech-tag tag-fe">React</span>, em t·∫°o wizard form v·ªõi nhi·ªÅu b∆∞·ªõc:
            </p>

            <pre><code><span class="comment">// TailoringOrderForm.jsx</span>
<span class="keyword">const</span> steps = [
    { id: 1, title: <span class="string">'Th√¥ng tin kh√°ch h√†ng'</span>, component: CustomerInfoStep },
    { id: 2, title: <span class="string">'Ch·ªçn s·∫£n ph·∫©m'</span>, component: ProductSelectStep },
    { id: 3, title: <span class="string">'Nh·∫≠p s·ªë ƒëo'</span>, component: MeasurementStep },
    { id: 4, title: <span class="string">'X√°c nh·∫≠n'</span>, component: ConfirmStep }
];

<span class="keyword">const</span> [currentStep, setCurrentStep] = <span class="function">useState</span>(1);
<span class="keyword">const</span> [formData, setFormData] = <span class="function">useState</span>({});</code></pre>

            <div class="lesson-box">
                <h4>üìù B√†i h·ªçc r√∫t ra</h4>
                <p class="story-text">
                    "Model your domain, not a generic solution." - H·ªá th·ªëng may ƒëo kh√°c ho√†n to√†n
                    v·ªõi e-commerce th√¥ng th∆∞·ªùng. ƒê·ª´ng c·ªë √©p v√†o m√¥ h√¨nh c√≥ s·∫µn.
                </p>
            </div>
        </div>

        <!-- CHAPTER 4: AUTHENTICATION -->
        <div class="chapter">
            <div class="chapter-number">4</div>
            <h2>B·∫£o M·∫≠t: JWT v√† Cu·ªôc Chi·∫øn Ch·ªëng Brute-force</h2>

            <p class="chapter-intro">
                Sau khi ƒë·ªçc v·ªÅ c√°c v·ª• hack, em quy·∫øt ƒë·ªãnh ƒë·∫ßu t∆∞ nghi√™m t√∫c v√†o b·∫£o m·∫≠t...
            </p>

            <h3>üîê JWT: Access Token + Refresh Token</h3>

            <div class="problem-box">
                <h4>ü§î V·∫•n ƒë·ªÅ: Token b·ªã ƒë√°nh c·∫Øp th√¨ sao?</h4>
                <p class="story-text">
                    N·∫øu d√πng 1 token v·ªõi th·ªùi h·∫°n 7 ng√†y, hacker c√≥ 7 ng√†y ƒë·ªÉ khai th√°c!
                </p>
            </div>

            <div class="solution-box">
                <h4>üí° Dual Token Strategy</h4>
                <ul class="story-text">
                    <li><strong>Access Token:</strong> S·ªëng 15 ph√∫t, d√πng cho m·ªçi API request</li>
                    <li><strong>Refresh Token:</strong> S·ªëng 7 ng√†y, ch·ªâ d√πng ƒë·ªÉ l·∫•y Access Token m·ªõi</li>
                </ul>
                <p class="story-text">
                    ‚Üí N·∫øu Access Token b·ªã ƒë√°nh c·∫Øp, hacker ch·ªâ c√≥ 15 ph√∫t. Refresh Token
                    l∆∞u trong database n√™n c√≥ th·ªÉ revoke ngay l·∫≠p t·ª©c.
                </p>
            </div>

            <h3>üõ°Ô∏è Ch·ªëng Brute-force: Multi-layer Protection</h3>

            <pre><code><span class="keyword">@Service</span>
<span class="keyword">public class</span> LoginAttemptService {
    <span class="keyword">private static final int</span> MAX_ATTEMPTS = 5;
    <span class="keyword">private static final int</span> LOCK_MINUTES = 15;
    
    <span class="keyword">public void</span> <span class="function">recordFailure</span>(String key) {
        Attempts attempts = cache.get(key);
        attempts.increment();
        
        <span class="keyword">if</span> (attempts.getCount() >= MAX_ATTEMPTS) {
            <span class="comment">// Lock account 15 ph√∫t</span>
            attempts.setLockedUntil(LocalDateTime.now().plusMinutes(LOCK_MINUTES));
        }
    }
}</code></pre>

            <p class="story-text">
                Nh∆∞ng ch·ªâ lock account kh√¥ng ƒë·ªß! Hacker c√≥ th·ªÉ th·ª≠ 1 password v·ªõi 10,000 accounts
                kh√°c nhau (credential stuffing). V√¨ v·∫≠y em th√™m:
            </p>

            <ul class="story-text">
                <li><strong>Layer 1:</strong> Account-level - 5 l·∫ßn sai = kh√≥a 15 ph√∫t</li>
                <li><strong>Layer 2:</strong> IP-level - 100 requests/ph√∫t</li>
                <li><strong>Layer 3:</strong> OTP - 3 l·∫ßn g·ª≠i/30 ph√∫t (ch·ªëng spam email)</li>
            </ul>

            <h3>üñ•Ô∏è Frontend: Token Management</h3>

            <pre><code><span class="comment">// api.js - Axios interceptor</span>
api.interceptors.response.use(
    response => response,
    <span class="keyword">async</span> error => {
        <span class="keyword">if</span> (error.response?.status === 401) {
            <span class="comment">// Access token h·∫øt h·∫°n, th·ª≠ refresh</span>
            <span class="keyword">try</span> {
                <span class="keyword">const</span> { accessToken } = <span class="keyword">await</span> <span class="function">refreshToken</span>();
                localStorage.<span class="function">setItem</span>(<span class="string">'accessToken'</span>, accessToken);
                
                <span class="comment">// Retry request ban ƒë·∫ßu</span>
                error.config.headers.Authorization = <span class="string">`Bearer ${accessToken}`</span>;
                <span class="keyword">return</span> api(error.config);
            } <span class="keyword">catch</span> (refreshError) {
                <span class="comment">// Refresh token c≈©ng h·∫øt h·∫°n ‚Üí logout</span>
                <span class="function">logout</span>();
            }
        }
        <span class="keyword">return</span> Promise.reject(error);
    }
);</code></pre>

            <div class="lesson-box">
                <h4>üìù B√†i h·ªçc r√∫t ra</h4>
                <p class="story-text">
                    "Defense in depth" - B·∫£o m·∫≠t l√† nhi·ªÅu l·ªõp ch·ªìng l√™n nhau.
                    Kh√¥ng c√≥ l·ªõp n√†o l√† ho√†n h·∫£o, nh∆∞ng k·∫øt h·ª£p l·∫°i th√¨ r·∫•t kh√≥ x√¢m nh·∫≠p.
                </p>
            </div>
        </div>

        <!-- CHAPTER 5: EVENT-DRIVEN -->
        <div class="chapter">
            <div class="chapter-number">5</div>
            <h2>Gi·∫£i Ph√≥ng User: Event-Driven Architecture</h2>

            <p class="chapter-intro">
                Ban ƒë·∫ßu, user ph·∫£i ƒë·ª£i 3-4 gi√¢y m·ªói khi t·∫°o ƒë∆°n h√†ng. T·∫°i sao l·∫°i l√¢u v·∫≠y?
            </p>

            <div class="problem-box">
                <h4>üêå V·∫•n ƒë·ªÅ: Synchronous Processing</h4>
                <pre><code><span class="keyword">public</span> OrderResponse <span class="function">createOrder</span>(OrderRequest request) {
    Order order = saveOrder(request);           <span class="comment">// 50ms</span>
    invoiceService.createInvoice(order);        <span class="comment">// 100ms</span>
    emailService.sendConfirmation(order);       <span class="comment">// 2000ms ‚Üê SMTP ch·∫≠m!</span>
    smsService.sendNotification(order);         <span class="comment">// 1500ms ‚Üê API ch·∫≠m!</span>
    
    <span class="keyword">return</span> toResponse(order);
}
<span class="comment">// Total: 3650ms - User ph·∫£i ƒë·ª£i g·∫ßn 4 gi√¢y!</span></code></pre>
            </div>

            <h3>üöÄ Gi·∫£i ph√°p: Publish Event v√† Return Ngay</h3>

            <pre><code><span class="keyword">public</span> OrderResponse <span class="function">createOrder</span>(OrderRequest request) {
    Order order = saveOrder(request);           <span class="comment">// 50ms</span>
    
    <span class="comment">// Publish event v√† return ngay!</span>
    eventPublisher.<span class="function">publishEvent</span>(<span class="keyword">new</span> OrderCreatedEvent(order));
    
    <span class="keyword">return</span> toResponse(order);
}
<span class="comment">// Total: ~100ms - User nh·∫≠n response g·∫ßn nh∆∞ ngay l·∫≠p t·ª©c!</span></code></pre>

            <p class="story-text">
                C√°c listeners x·ª≠ l√Ω async ·ªü background:
            </p>

            <pre><code><span class="keyword">@Component</span>
<span class="keyword">public class</span> OrderEventListeners {
    
    <span class="keyword">@Async</span>
    <span class="keyword">@EventListener</span>
    <span class="keyword">public void</span> <span class="function">createInvoice</span>(OrderCreatedEvent event) {
        invoiceService.<span class="function">createForOrder</span>(event.getOrder());
    }
    
    <span class="keyword">@Async</span>
    <span class="keyword">@EventListener</span>
    <span class="keyword">public void</span> <span class="function">sendEmail</span>(OrderCreatedEvent event) {
        emailService.<span class="function">sendOrderConfirmation</span>(event.getOrder());
    }
}</code></pre>

            <h3>üñ•Ô∏è Frontend: Optimistic UI</h3>

            <p class="story-text">
                Ph√≠a Frontend, em apply <span class="highlight">Optimistic Update</span> -
                c·∫≠p nh·∫≠t UI ngay tr∆∞·ªõc khi API response:
            </p>

            <pre><code><span class="keyword">const</span> <span class="function">handleAddToCart</span> = <span class="keyword">async</span> (product) => {
    <span class="comment">// 1. Update UI ngay l·∫≠p t·ª©c (optimistic)</span>
    <span class="function">setCartItems</span>(prev => [...prev, product]);
    <span class="function">showToast</span>(<span class="string">'ƒê√£ th√™m v√†o gi·ªè h√†ng!'</span>);
    
    <span class="keyword">try</span> {
        <span class="comment">// 2. G·ªçi API ·ªü background</span>
        <span class="keyword">await</span> api.<span class="function">addToCart</span>(product.id);
    } <span class="keyword">catch</span> (error) {
        <span class="comment">// 3. N·∫øu fail, rollback UI</span>
        <span class="function">setCartItems</span>(prev => prev.filter(p => p.id !== product.id));
        <span class="function">showToast</span>(<span class="string">'L·ªói! Vui l√≤ng th·ª≠ l·∫°i.'</span>);
    }
};</code></pre>

            <div class="lesson-box">
                <h4>üìù B√†i h·ªçc r√∫t ra</h4>
                <p class="story-text">
                    "Don't make users wait for non-critical operations." - G·ª≠i email, t·∫°o invoice
                    kh√¥ng quan tr·ªçng b·∫±ng vi·ªác user nh·∫≠n ƒë∆∞·ª£c x√°c nh·∫≠n ƒë∆°n h√†ng ngay.
                </p>
            </div>
        </div>

        <!-- CHAPTER 6: CACHING -->
        <div class="chapter">
            <div class="chapter-number">6</div>
            <h2>TƒÉng T·ªëc: Redis Cache v√† Performance</h2>

            <p class="chapter-intro">
                Khi product catalog l√™n ƒë·∫øn h√†ng ngh√¨n s·∫£n ph·∫©m, database query tr·ªü n√™n ch·∫≠m...
            </p>

            <div class="problem-box">
                <h4>üêå V·∫•n ƒë·ªÅ: Database Bottleneck</h4>
                <p class="story-text">
                    M·ªói request ƒë·∫øn trang Products ƒë·ªÅu ph·∫£i query database. V·ªõi 100 users
                    c√πng l√∫c, database connections c·∫°n ki·ªát!
                </p>
            </div>

            <h3>üîß Gi·∫£i ph√°p: Redis Cache Layer</h3>

            <pre><code><span class="keyword">@Cacheable</span>(value = <span class="string">"products"</span>, key = <span class="string">"#id"</span>)
<span class="keyword">public</span> ProductResponse <span class="function">getProduct</span>(Long id) {
    <span class="comment">// L·∫ßn ƒë·∫ßu: query DB, l∆∞u v√†o Redis</span>
    <span class="comment">// L·∫ßn sau: tr·∫£ v·ªÅ t·ª´ Redis ngay (&lt;1ms)</span>
    <span class="keyword">return</span> productRepository.<span class="function">findById</span>(id)
        .map(<span class="keyword">this</span>::toResponse)
        .orElseThrow();
}

<span class="keyword">@CacheEvict</span>(value = <span class="string">"products"</span>, key = <span class="string">"#id"</span>)
<span class="keyword">public void</span> <span class="function">updateProduct</span>(Long id, ProductRequest request) {
    <span class="comment">// Khi update, x√≥a cache c≈©</span>
    <span class="comment">// L·∫ßn query ti·∫øp theo s·∫Ω l·∫•y data m·ªõi t·ª´ DB</span>
}</code></pre>

            <p class="story-text">
                K·∫øt qu·∫£:
            </p>

            <table style="width: 100%; margin: 20px 0;">
                <tr>
                    <th>Metric</th>
                    <th>Tr∆∞·ªõc (DB only)</th>
                    <th>Sau (Redis cache)</th>
                </tr>
                <tr>
                    <td>Response time</td>
                    <td>50-100ms</td>
                    <td>&lt;5ms</td>
                </tr>
                <tr>
                    <td>DB queries/second</td>
                    <td>1000</td>
                    <td>~50 (cache hits)</td>
                </tr>
                <tr>
                    <td>Max concurrent users</td>
                    <td>~100</td>
                    <td>~1000+</td>
                </tr>
            </table>

            <h3>üñ•Ô∏è Frontend: Image Lazy Loading</h3>

            <p class="story-text">
                Ph√≠a Frontend, trang Products v·ªõi 50+ h√¨nh ·∫£nh r·∫•t n·∫∑ng. Em implement lazy loading:
            </p>

            <pre><code><span class="comment">// ProductImage.jsx</span>
<span class="keyword">const</span> [isVisible, setIsVisible] = <span class="function">useState</span>(<span class="keyword">false</span>);
<span class="keyword">const</span> imgRef = <span class="function">useRef</span>();

<span class="function">useEffect</span>(() => {
    <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="function">IntersectionObserver</span>((entries) => {
        <span class="keyword">if</span> (entries[0].isIntersecting) {
            <span class="function">setIsVisible</span>(<span class="keyword">true</span>);
            observer.<span class="function">disconnect</span>();
        }
    });
    observer.<span class="function">observe</span>(imgRef.current);
    <span class="keyword">return</span> () => observer.<span class="function">disconnect</span>();
}, []);

<span class="keyword">return</span> (
    <span class="keyword">&lt;div</span> ref={imgRef}<span class="keyword">&gt;</span>
        {isVisible ? (
            <span class="keyword">&lt;img</span> src={product.imageUrl} alt={product.name} <span class="keyword">/&gt;</span>
        ) : (
            <span class="keyword">&lt;div</span> className=<span class="string">"placeholder"</span><span class="keyword">&gt;</span>Loading...<span class="keyword">&lt;/div&gt;</span>
        )}
    <span class="keyword">&lt;/div&gt;</span>
);</code></pre>

            <div class="lesson-box">
                <h4>üìù B√†i h·ªçc r√∫t ra</h4>
                <p class="story-text">
                    "Use the right tool for the right job." - Database cho persistence,
                    Redis cho speed. ƒê·ª´ng b·∫Øt database l√†m vi·ªác c·ªßa cache.
                </p>
            </div>
        </div>

        <!-- CHAPTER 7: DEBUGGING JOURNEY -->
        <div class="chapter">
            <div class="chapter-number">7</div>
            <h2>3 Gi·ªù S√°ng: Nh·ªØng Bugs ƒê√°ng Nh·ªõ</h2>

            <p class="chapter-intro">
                Kh√¥ng c√≥ d·ª± √°n n√†o ho√†n h·∫£o. ƒê√¢y l√† nh·ªØng bugs kh√≥ qu√™n nh·∫•t...
            </p>

            <h3>üêõ Bug 1: "T·∫°i sao order.total lu√¥n = 0?"</h3>

            <div class="problem-box">
                <h4>Tri·ªáu ch·ª©ng</h4>
                <p class="story-text">
                    T·∫•t c·∫£ ƒë∆°n h√†ng ƒë·ªÅu c√≥ total = 0, d√π items c√≥ gi√° ƒë√∫ng.
                </p>
            </div>

            <div class="solution-box">
                <h4>Nguy√™n nh√¢n & Fix</h4>
                <p class="story-text">
                    Em t√≠nh total SAU khi ƒë√£ save order, nh∆∞ng kh√¥ng save l·∫°i!
                </p>
                <pre><code>Order order = orderRepository.<span class="function">save</span>(new Order());

<span class="keyword">for</span> (Item item : items) {
    order.setTotal(order.getTotal().add(item.getSubtotal()));
}

<span class="comment">// BUG: Qu√™n save l·∫°i order v·ªõi total m·ªõi!</span>
<span class="comment">// FIX: Th√™m d√≤ng n√†y</span>
orderRepository.<span class="function">save</span>(order);</code></pre>
            </div>

            <h3>üêõ Bug 2: "Flash sale stock th√†nh s·ªë √¢m?"</h3>

            <div class="problem-box">
                <h4>Tri·ªáu ch·ª©ng</h4>
                <p class="story-text">
                    availableQuantity hi·ªÉn th·ªã -5, nghƒ©a l√† ƒë√£ b√°n qu√° 5 s·∫£n ph·∫©m!
                </p>
            </div>

            <div class="solution-box">
                <h4>Nguy√™n nh√¢n & Fix</h4>
                <p class="story-text">
                    Race condition! Em ƒëang d√πng <code>READ_COMMITTED</code> thay v√¨
                    <code>SERIALIZABLE</code> isolation level.
                </p>
                <pre><code><span class="comment">// BEFORE</span>
<span class="keyword">@Transactional</span>
<span class="keyword">public</span> Result <span class="function">purchase</span>(...) { ... }

<span class="comment">// AFTER</span>
<span class="keyword">@Transactional</span>(isolation = Isolation.SERIALIZABLE)
<span class="keyword">public</span> Result <span class="function">purchase</span>(...) { ... }</code></pre>
            </div>

            <h3>üêõ Bug 3: Frontend "Cannot read property 'map' of undefined"</h3>

            <div class="problem-box">
                <h4>Tri·ªáu ch·ª©ng</h4>
                <p class="story-text">
                    Trang Products crash ngay khi load.
                </p>
            </div>

            <div class="solution-box">
                <h4>Nguy√™n nh√¢n & Fix</h4>
                <p class="story-text">
                    API tr·∫£ v·ªÅ <code>{ data: null }</code> khi kh√¥ng c√≥ products,
                    nh∆∞ng Frontend expect array.
                </p>
                <pre><code><span class="comment">// BEFORE</span>
<span class="keyword">const</span> products = response.data;
products.<span class="function">map</span>(...); <span class="comment">// CRASH n·∫øu data = null</span>

<span class="comment">// AFTER</span>
<span class="keyword">const</span> products = response.data || [];
products.<span class="function">map</span>(...); <span class="comment">// Safe!</span></code></pre>
            </div>

            <div class="lesson-box">
                <h4>üìù B√†i h·ªçc r√∫t ra</h4>
                <p class="story-text">
                    "Defensive programming" - Lu√¥n assume data c√≥ th·ªÉ null/undefined.
                    Vi·∫øt code ƒë·ªÉ handle edge cases, kh√¥ng ch·ªâ happy path.
                </p>
            </div>
        </div>

        <!-- CLOSING -->
        <div class="chapter" style="border-left: none; padding-left: 40px;">
            <h2>K·∫øt Lu·∫≠n: Nh·ªØng G√¨ Em H·ªçc ƒê∆∞·ª£c</h2>

            <p class="story-text">
                Sau h√†nh tr√¨nh x√¢y d·ª±ng Tailor Shop, em r√∫t ra nh·ªØng b√†i h·ªçc quan tr·ªçng:
            </p>

            <ol class="story-text">
                <li>
                    <strong>Hi·ªÉu domain tr∆∞·ªõc khi code:</strong> May ƒëo kh√°c e-commerce th√¥ng th∆∞·ªùng.
                    ƒê·ª´ng c·ªë √©p v√†o m√¥ h√¨nh c√≥ s·∫µn.
                </li>
                <li>
                    <strong>Start simple, evolve when needed:</strong> Modular Monolith cho ph√©p
                    ph√°t tri·ªÉn nhanh, c√≥ th·ªÉ t√°ch Microservices sau.
                </li>
                <li>
                    <strong>Think about failure cases:</strong> User b·ªè gi·ªØa ch·ª´ng? M·∫•t m·∫°ng?
                    Hai ng∆∞·ªùi mua c√πng l√∫c? Chu·∫©n b·ªã cho t·∫•t c·∫£.
                </li>
                <li>
                    <strong>Don't make users wait:</strong> Event-driven, async processing,
                    optimistic UI gi√∫p UX t·ªët h∆°n.
                </li>
                <li>
                    <strong>Defense in depth:</strong> Security c·∫ßn nhi·ªÅu l·ªõp b·∫£o v·ªá ch·ªìng l√™n nhau.
                </li>
            </ol>

            <div class="quote">
                "Anyone can write code that works. Engineers write code that handles when things go wrong."
            </div>
        </div>

        <footer>
            <p>üßµ Tailor Shop Project Story</p>
            <p style="margin-top: 10px;">Created with üíª and lots of ‚òï</p>
        </footer>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose'
        });
    </script>
</body>

</html>